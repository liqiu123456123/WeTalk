<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>欢迎注册WeTalk</title>

    <!-- Favicon -->
    <link rel="icon" href="/static/media/img/favicon.png" type="image/png">

    <!-- Soho css -->
    <link rel="stylesheet" href="/static/css/soho.min.css">
</head>
<body class="form-membership">

<div class="form-wrapper">

    <!-- logo -->
    <div class="logo">
        <svg  version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
              width="50.004px" height="50.003px" viewBox="0 0 33.004 33.003" style="enable-background:new 0 0 33.004 33.003;"
              xml:space="preserve">
            <g>
                <path d="M4.393,4.788c-5.857,5.857-5.858,15.354,0,21.213c4.875,4.875,12.271,5.688,17.994,2.447l10.617,4.161l-4.857-9.998
                    c3.133-5.697,2.289-12.996-2.539-17.824C19.748-1.072,10.25-1.07,4.393,4.788z M25.317,22.149l0.261,0.512l1.092,2.142l0.006,0.01
                    l1.717,3.536l-3.748-1.47l-0.037-0.015l-2.352-0.883l-0.582-0.219c-4.773,3.076-11.221,2.526-15.394-1.646
                    C1.469,19.305,1.469,11.481,6.277,6.672c4.81-4.809,12.634-4.809,17.443,0.001C27.919,10.872,28.451,17.368,25.317,22.149z"/>
                <g>
                    <circle cx="9.835" cy="16.043" r="1.833"/>
                    <circle cx="15.502" cy="16.043" r="1.833"/>
                    <circle cx="21.168" cy="16.043" r="1.833"/>
                </g>
            </g>
            <g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g>
        </svg>
    </div>
    <!-- ./ logo -->

    <h5>注册账号</h5>

    <!-- form -->
    <form action="" method="post">
        {% csrf_token %}
        <div class="form-group input-group-lg">
            <input type="text" name="username" class="form-control" placeholder="昵称" required>
        </div>
        <div class="form-group input-group-lg">
            <input type="email" name="email" class="form-control" placeholder="邮箱" required>
        </div>
        <div class="form-group input-group-lg">
            <input type="password" name="password" class="form-control" placeholder="密码" required>
        </div>
        {% if confirmPassword %}
        <div class="form-group input-group-lg">
            <input type="password" name="repeat_password" class="form-control" placeholder="重复密码" required>
        </div>
        {% endif %}
    
    <!-- 添加获取邮箱验证码的输入框 -->  
    <div class="form-group input-group-lg">  
        <input type="text" name="email_verification_code" class="form-control" placeholder="请输入邮箱验证码" required>  
    </div>  
    <!-- 添加一个按钮或链接来发送验证码 -->  
    <div class="form-group">  
        <button type="button" class="btn btn-secondary btn-lg btn-block" id="send-verification-code">发送验证码</button>  
    </div>  
    <div>{{ tips }}</div>
        <button class="btn btn-primary btn-lg btn-block">注册</button>
        <hr>
        <p class="text-muted">已经有账号?</p>
        <a href="./login.html" class="btn btn-outline-light btn-sm">去登陆!</a>
    </form>
    <!-- ./ form -->

</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>  
<script>  
$(document).ready(function() {  
    $('#send-verification-code').click(function() { 
         // 禁用按钮，防止用户重复点击  
        $(this).prop('disabled', true);  
          
        // 改变按钮文本  
        $(this).text('已发送');  
        var csrfToken = $('input[name="csrfmiddlewaretoken"]').val();  
        console.log(csrfToken);
        var email = $('input[name="email"]').val(); // 假设你的邮箱输入框的name属性为"email"  
        if (!email) {  
            $('#tips').text('请输入邮箱地址');  
            return;  
        }  
  
        $.ajax({  
            url: '../send_code/',  
            type: 'POST',  
            data: { email: email,csrfmiddlewaretoken: csrfToken},  
            success: function(response) {  
                if (response.message) {  
                    $('#tips').text(response.message);  
                } else {  
                    $('#tips').text('未知错误');  
                }  
            },  
            error: function(xhr, status, error) {  
                $('#tips').text('发送验证码失败: ' + error);  
            }  
        });  
    });  
});  
</script>
<!-- JQuery -->
<script src="https://www.jq22.com/jquery/jquery-1.10.2.js"></script>

<!-- Popper.js -->
<script src="/static/js/popper.min.js"></script>

<!-- Bootstrap -->
<script src="/static/js/bootstrap.min.js"></script>

<!-- Soho -->
<script src="/static/js/soho.min.js"></script>
</body>
</html>